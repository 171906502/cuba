<window class="com.haulmont.cuba.web.app.ui.security.group.browse.SecurityGroupBrowser">
    <metadataContext>
        <deployViews name="/com/haulmont/cuba/web/app/ui/security/group/browse/security-group-browse.views.xml"/>
    </metadataContext>

    <dsContext>
        <collectionDatasource
            id="groups"
            class="com.haulmont.cuba.security.entity.Group"
            view="group-browse">
            <query>
                <![CDATA[select g from sec$Group g]]>
            </query>
        </collectionDatasource>

        <collectionDatasource
            id="profiles"
            class="com.haulmont.cuba.security.entity.Profile"
            view="group-browse">
            <query>select p from sec$Profile p where p.group.id = :ds$groups</query>
        </collectionDatasource>

        <collectionDatasource
            id="subjects"
            class="com.haulmont.cuba.security.entity.Subject"
            view="group-browse">
            <query>select s from sec$Subject s join fetch s.user where s.profile.id = :ds$profiles</query>
        </collectionDatasource>
    </dsContext>

    <layout>
        <hbox id="tree-panel" expand="table">
            <split orientation="horizontal">
                <vbox>
                    <tree id="groups">
                        <treechildren datasource="groups" property="name" parent="parent"/>
                    </tree>
                </vbox>
                <split orientation="vertical">
                    <table id="profiles">
                        <columns>
                            <column id="name" caption="Profile"/>
                        </columns>
                        <rows datasource="profiles"/>
                    </table>
                    <table id="subjects">
                        <columns>
                            <column id="user" caption="User" onClick="sec$User.edit"/>
                            <column id="defaultSubject" caption="Default"/>
                        </columns>
                        <rows datasource="subjects"/>
                    </table>
                </split>
            </split>
        </hbox>
    </layout>
</window>
